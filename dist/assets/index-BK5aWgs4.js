var N=Object.defineProperty;var Y=(i,t,e)=>t in i?N(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var b=(i,t,e)=>Y(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();const k=299792458,z=k**2*10**-7,A=.5,y=2,F=10**22,v=1,P=10;class u{constructor(t,e){this.x=t,this.y=e}get isNull(){return this.x===0&&this.y===0}get magnitude(){return Math.sqrt(this.x**2+this.y**2)}get magnitudeSquared(){return this.dotProduct(this)}get versor(){return this.magnitude===0?u.zero():this.multiplyByScalar(1/this.magnitude)}get componentX(){return new u(this.x,0)}get componentY(){return new u(0,this.y)}add(t){return new u(this.x+t.x,this.y+t.y)}subtract(t){return new u(this.x-t.x,this.y-t.y)}multiplyByScalar(t){return new u(this.x*t,this.y*t)}dotProduct(t){return this.x*t.x+this.y*t.y}changeMagnitude(t){return this.versor.multiplyByScalar(t)}toPosition(){return new T(this.x,this.y)}isLessThan(t){return this.x<t&&this.x>-t&&this.y<t&&this.y>-t}static zero(){return new u(0,0)}}class T{constructor(t,e){this.x=t,this.y=e}get vector(){return new u(this.x,this.y)}}function O(i,t){return typeof i=="string"?W(i):i instanceof Array?H(i):typeof t=="number"?_(i,t):typeof i=="number"?D(i):Math.random()}function D(i){const t=Math.random()*i;return i>1?Math.floor(t):t}function _(i,t){return Math.floor(Math.random()*(t-i+1)+i)}function H(i){return i[Math.floor(Math.random()*i.length)]}function W(i){return i[Math.floor(Math.random()*i.length)]}const G="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-!@#";function q(i=6){let t="";for(let e=0;e<i;e++)t+=O(G);return t}const L=20,K=25;var p=(i=>(i[i.ELECTRON=-16000000000000002e-35]="ELECTRON",i[i.PROTON=16000000000000002e-35]="PROTON",i[i.NEUTRON=0]="NEUTRON",i))(p||{});const U={[-16000000000000002e-35]:{stroke:"rgb(53, 186, 255)",glowColor:"rgba(0, 192, 255, 0.8)",symbol:"-"},16000000000000002e-35:{stroke:"rgb(255, 66, 82)",glowColor:"rgba(255, 64, 80, 0.8)",symbol:"+"},0:{stroke:"rgb(199, 204, 212)",glowColor:"rgba(150, 160, 172, 0.8)",symbol:""}};class E{constructor(t,e,r,s,o,n){this.id=t,this.value=e,this.mass=r,this.position=s,this.velocity=o,this.acceleration=n}get length(){return L+(this.mass-v)/(P-v)*(K-L)}get isMassive(){return this.value!==0&&this.mass>=40}frame(t,e){const{otherCharges:r,world:s}=e;this.resolveOverlapWithEdge(s);let o=u.zero();if(r.length>1)for(const n of r)this!==n&&(this.resolveCollision(n),o=this.resolveCoulombAttraction(o,n));if(o.isNull||(this.acceleration=o.multiplyByScalar(1/this.mass)),!this.velocity.isNull||!this.acceleration.isNull){let n=this.velocity.add(this.acceleration.multiplyByScalar(t));n=n.multiplyByScalar(.98),this.isCollidedHorizontallyOnEdge(s)&&(n.x*=-1),this.isCollidedVerticallyOnEdge(s)&&(n.y*=-1);const a=this.position.vector.add(n.multiplyByScalar(t)).add(this.acceleration.multiplyByScalar(t**2/2)).toPosition();this.position=a,this.velocity=n}}resolveOverlapWithEdge(t){const{position:e,length:r}=this,s=r/2,o=t.innerLeftX-(e.x-s);o>=y&&(e.x+=o);const n=e.x+s-t.innerRightX;n>=y&&(e.x-=n);const l=t.innerTopY-(e.y-s);l>=y&&(e.y+=l);const a=e.y+s-t.innerBottomY;a>=y&&(e.y-=a)}resolveCollision(t){if(this.id.localeCompare(t.id)>0)return;const e=(t.length+this.length)/2;let r=t.position.vector.subtract(this.position.vector);const s=r.magnitude;if(s>=e)return;const o=s-e;if(o<0){const w=-o/2;t.position=t.position.vector.add(r.changeMagnitude(w)).toPosition(),this.position=this.position.vector.add(r.changeMagnitude(w).multiplyByScalar(-1)).toPosition(),r=t.position.vector.subtract(this.position.vector)}const n=r.versor,l=t.velocity.subtract(this.velocity).dotProduct(n);if(l===0)return;const a=t.mass*this.mass/(t.mass+this.mass),S=(t.mass*t.velocity.dotProduct(n)**2+this.mass*this.velocity.dotProduct(n)**2)/2*(A-1),C=-(1+Math.sqrt(1-2*S/(a*l**2)))*l/(1/t.mass+1/this.mass),I=t.velocity.add(n.multiplyByScalar(C/t.mass)),X=this.velocity.subtract(n.multiplyByScalar(C/this.mass));t.velocity=I,this.velocity=X}resolveCoulombAttraction(t,e){const r=this.position.vector.subtract(e.position.vector),s=r.dotProduct(r)*10**-6;if(s===0)return t;const o=z*Math.abs(this.value)*Math.abs(e.value)/s*F;let n=this.value*e.value;n!==0&&(n/=Math.abs(n));const l=r.changeMagnitude(o).multiplyByScalar(n);return t.add(l)}render(t,e){const{stroke:r,glowColor:s,symbol:o}=U[this.value],n=this.length/2;if(this.isMassive){const l=performance.now()*.001,a=20+Math.sin(l*Math.PI*2*.8)*20;t.save(),t.translate(this.position.x,this.position.y),t.shadowColor=s,t.shadowBlur=60,t.lineWidth=0,t.beginPath(),t.arc(0,0,n,0,Math.PI*2),t.stroke(),t.restore(),t.save(),t.translate(this.position.x,this.position.y),t.shadowColor=s,t.shadowBlur=20,t.lineWidth=0,t.beginPath(),t.arc(0,0,n,0,Math.PI*2),t.stroke(),t.restore(),t.save(),t.translate(this.position.x,this.position.y),t.shadowColor=s,t.shadowBlur=a,t.lineWidth=0,t.beginPath(),t.arc(0,0,n,0,Math.PI*2),t.stroke(),t.restore()}t.save(),t.translate(this.position.x,this.position.y),t.shadowBlur=this.isMassive?60:25,t.shadowColor=s,t.lineWidth=this.isMassive?4:2,t.strokeStyle=r,t.beginPath(),t.arc(0,0,n,0,Math.PI*2),t.stroke(),t.shadowBlur=0,t.fillStyle=r,t.font=`600 ${n*1.6}px Roboto, sans-serif`,t.textAlign="center",t.textBaseline="middle",t.fillText(o,0,1),t.restore()}drawVector(t,e,r,s=1){if(e.isNull)return;const o=e.x*s,n=e.y*s;t.strokeStyle=r,t.lineWidth=2,t.beginPath(),t.moveTo(0,0),t.lineTo(o,n),t.stroke();const l=10,a=Math.PI/6,f=Math.atan2(n,o);t.beginPath(),t.moveTo(o,n),t.lineTo(o-l*Math.cos(f-a),n-l*Math.sin(f-a)),t.stroke(),t.beginPath(),t.moveTo(o,n),t.lineTo(o-l*Math.cos(f+a),n-l*Math.sin(f+a)),t.stroke()}isPointInside(t){const e=this.length/2,r=this.position.x-t.x,s=this.position.y-t.y;return Math.sqrt(r*r+s*s)<=e}isCollidedHorizontallyOnEdge(t){const{position:e,length:r}=this,s=r/2,o=e.x-s,n=e.x+s;return t.isCollidedLeftOnEdge(o)||t.isCollidedRightOnEdge(n)}isCollidedVerticallyOnEdge(t){const{position:e,length:r}=this,s=r/2,o=e.y-s,n=e.y+s;return t.isCollidedTopOnEdge(o)||t.isCollidedBottomOnEdge(n)}static create(t,e,r){return new E(q(6),t,e,r,u.zero(),u.zero())}}class V{constructor(t){b(this,"charges",[]);this.world=t}addCharge(t){this.charges.push(t)}removeCharge(t){const e=this.charges.findIndex(r=>r.id===t);e!==-1&&this.charges.splice(e,1)}getChargeFromPoint(t){return this.charges.find(e=>e.isPointInside(t))||null}frame(t){for(const e of this.charges)e.frame(t,{world:this.world,otherCharges:this.charges})}}const h=1;class j{constructor(t,e,r,s,o){this.x=t,this.y=e,this.width=r,this.height=s,this.edgeLength=o}get innerLeftX(){return this.x+this.edgeLength}get innerTopY(){return this.y+this.edgeLength}get innerRightX(){return this.x+this.width-this.edgeLength}get innerBottomY(){return this.y+this.height-this.edgeLength}get outerLeftX(){return this.x}get outerTopY(){return this.y}get outerRightX(){return this.x+this.width}get outerBottomY(){return this.y+this.height}isCollidedLeftOnEdge(t){return t>=this.outerLeftX-h&&t<=this.innerLeftX+h}isCollidedRightOnEdge(t){return t>=this.innerRightX-h&&t<=this.outerRightX+h}isCollidedHorizontallyOnEdge(t){return this.isCollidedLeftOnEdge(t)||this.isCollidedRightOnEdge(t)}isCollidedTopOnEdge(t){return t>=this.outerTopY-h&&t<=this.innerTopY+h}isCollidedBottomOnEdge(t){return t>=this.innerBottomY-h&&t<=this.outerBottomY+h}isCollidedVerticallyOnEdge(t){return this.isCollidedTopOnEdge(t)||this.isCollidedBottomOnEdge(t)}isCollidedOnEdge(t){return this.isCollidedHorizontallyOnEdge(t.x)||this.isCollidedVerticallyOnEdge(t.y)}isInsideOfLeftEdge(t){return t>=this.outerLeftX-h&&t<=this.innerLeftX}isInsideOfRightEdge(t){return t>=this.innerRightX-h&&t<=this.outerRightX}isInsideOfTopEdge(t){return t>=this.outerTopY-h&&t<=this.innerTopY}isInsideOfBottomEdge(t){return t>=this.innerBottomY-h&&t<=this.outerBottomY}isOutsideHorizontally(t){return t<this.outerLeftX||t>this.outerRightX}isOutsideVertically(t){return t<this.outerTopY||t>this.outerBottomY}isOutside(t){return this.isOutsideHorizontally(t.x)||this.isOutsideVertically(t.y)}}const c=document.getElementById("root"),d=c.getContext("2d"),g=new j(0,0,c.width,c.height,0);function B(){c.width=window.innerWidth,c.height=window.innerHeight,g.width=c.width,g.height=c.height}window.addEventListener("resize",B);B();const m=new V(g);document.addEventListener("contextmenu",i=>i.preventDefault());c.addEventListener("mousedown",i=>{const t=new T(i.x,i.y),e=m.getChargeFromPoint(t);if(e){if(i.button===0){const s=e.position.vector.subtract(t.vector),o=s.versor,n=s.magnitude/(e.length/2),l=o.multiplyByScalar(n);e.velocity=e.velocity.add(l)}if(i.button===1){const s=i.shiftKey?10:1;e.mass+=i.ctrlKey?-s:s}i.button===2&&m.removeCharge(e.id);return}let r;switch(i.button){case 0:r=p.ELECTRON;break;case 2:r=p.PROTON;break;default:r=p.NEUTRON}m.addCharge(E.create(r,O(v,P),t))});let M=Date.now();function R(){const i=Date.now(),t=i-M;M=i,m.frame(t),J(),requestAnimationFrame(R)}function J(){Q();for(const i of m.charges)i.render(d,c)}function Q(){const{width:i,height:t}=c,e=d.createRadialGradient(i*.5,t*.4,0,i*.5,t*.4,Math.max(i,t));e.addColorStop(0,"#05070d"),e.addColorStop(1,"#0d111a"),d.fillStyle=e,d.fillRect(0,0,i,t),d.strokeStyle="#0d172c",d.lineWidth=g.edgeLength,d.strokeRect(g.innerLeftX/2,g.innerTopY/2,g.innerRightX,g.innerBottomY);const r=document.createElement("canvas");r.width=r.height=128;const s=r.getContext("2d"),o=s.createImageData(128,128);for(let l=0;l<o.data.length;l+=4){const a=Math.random()*255;o.data[l]=o.data[l+1]=o.data[l+2]=a,o.data[l+3]=.05*255}s.putImageData(o,0,0);const n=d.createPattern(r,"repeat");d.fillStyle=n,d.globalAlpha=.15,d.fillRect(0,0,i,t),d.globalAlpha=1}R();
